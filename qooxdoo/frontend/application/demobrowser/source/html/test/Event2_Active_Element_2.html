<html>

<head>
  <title>qooxdoo &raquo; Demo Browser</title>
  <script type="text/javascript" src="../../script/demo.js"></script>
  <script type="text/javascript" src="../util.js"></script>
</head>


<body>

  <div id="description">
  document.activeElement test with iframe
  </div>

  <p>Try clicking in various things.  The next paragraph should reflect the active element.</p>

  <div id="output">?</div>

  <iframe src="Event2_Active_Element_1.html" width="600" height="300"></iframe>

  <p>Try <strong>clicking in</strong> or <em>selecting portions of</em> this styled paragraph.</p>

  <p>Try focusing various form elements:</p>

  <textarea></textarea>
  <input>
  <input type="checkbox">
  <input type="button" value="button">
  <button>button</button>
  <br>
  <br>

  <p>Bogus text</p>

	<script type="text/javascript">

qx.Class.define("BasicSample",
{
  extend : qx.application.Basic,

  members :
  {
    main : function()
    {
      this.base(arguments);
      //var em = new qx.event.Manager.getInstance();
    }
  }
});

qx.core.Init.getInstance().setApplication(new BasicSample);


/**
 * Original code
 */
setInterval(check, 200);

function check()
{
  var s = getActiveElement();
  var output = document.getElementById("output")
  if (output)
    output.innerHTML = s; // textContent would be better, but innerHTML is easy and supported by everything
  else
    window.status = "Script in frameset (top) says: " + s;

}

function getActiveElement()
{
  var rv;

  var el = qx.event.Manager.getInstance().getActiveElement();
  if (!el) {
    rv = "none";
    return rv;
  }

  if (el && el != document.documentElement) {
    var nt;
    try {
      nt = el.nodeType;
    } catch (e) {
      rv = "[no permission]";
      return rv;
    }
    if (!nt) {
      rv = "[unknown]";
    } else if (nt == 1) {
      rv = el.tagName;
    } else if (nt == 3) {
      rv = "textnode"
    } else {
      rv = nt;
    }

    el = el.parentNode;
    while (el && el != document.documentElement) {
      rv += " in ";
      try {
        nt = el.nodeType;
      } catch (e) {
        rv += "[no permission]";
        return rv;
      }
      if (!nt) {
        rv += "[unknown]";
      } else if (nt == 1) {
        rv += el.tagName;
      } else if (nt == 3) {
        rv += "textnode"
      } else {
        rv += nt;
      }

      el = el.parentNode;
    }
  }

  return rv;
}

		</script>

</body>


</html>
